# Hibernate


**ORM (Objec Relational Mapping)** - –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç

**Hibernate** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç (ORM framework)


–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ —ç—Ç–æ –º–æ–∂–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

[![hibernate](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibernate-768x260.jpg?resize=700%2C237)](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibernate.jpg)

–ö–∞–∫–∏–µ –∂–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞—ë—Ç –Ω–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Hibernate?

- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π API –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è Java-–æ–±—ä–µ–∫—Ç–æ–≤ –≤/–∏–∑ –ë–î.
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ë–î, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ fetching.
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–∞ SQL, –∞ –∏–º–µ—Ç—å –¥–µ–ª–æ —Å –ø—Ä–∏–≤—ã—á–Ω—ã–º–∏ –Ω–∞–º —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö Java.
- –ó–∞–±–æ—Ç–∏—Ç—Å—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É Java-–∫–ª–∞—Å—Å–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ë–î —Å –ø–æ–º–æ—â—å—é XML-—Ñ–∞–π–ª–æ–≤ –Ω–µ –≤–Ω–æ—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥.
- –ï—Å–ª–∏ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –ë–î, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏—à—å –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ XML-—Ñ–∞–π–ª—ã.


#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.

Hibernate ‚Äì —ç—Ç–æ ORM —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Java —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º. –≠—Ç–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞–π–Ω–µ –º–æ—â–Ω–æ–π –∏ –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

Hibernate —Å–æ–∑–¥–∞—ë—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–¥–∞–ª–µ–µ ‚Äì –ë–î) –∏ Java-–∫–ª–∞—Å—Å–∞–º–∏ –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç. –≠—Ç–æ –∏–∑–±–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –æ—Ç –æ–≥—Ä–æ–º–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–∏—à–Ω–µ–π, —Ä—É—Ç–∏–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –≤ –∫–æ—Ç–æ—Ä–æ–π –∫—Ä–∞–π–Ω–µ –ª–µ–≥–∫–æ –¥–æ–ø—É—Å—Ç–∏—Ç—å –æ—à–∏–±–∫—É –∏ –∫—Ä–∞–π–Ω–µ —Ç—Ä—É–¥–Ω–æ –ø–æ—Ç–æ–º –µ—ë –Ω–∞–π—Ç–∏.

–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ —ç—Ç–æ –º–æ–∂–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

[![hibernate](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibernate-768x260.jpg?resize=700%2C237)](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibernate.jpg)

–ö–∞–∫–∏–µ –∂–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞—ë—Ç –Ω–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Hibernate?

- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π API –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è Java-–æ–±—ä–µ–∫—Ç–æ–≤ –≤/–∏–∑ –ë–î.
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ë–î, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ fetching.
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–∞ SQL, –∞ –∏–º–µ—Ç—å –¥–µ–ª–æ —Å –ø—Ä–∏–≤—ã—á–Ω—ã–º–∏ –Ω–∞–º —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö Java.
- –ó–∞–±–æ—Ç–∏—Ç—Å—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É Java-–∫–ª–∞—Å—Å–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ë–î —Å –ø–æ–º–æ—â—å—é XML-—Ñ–∞–π–ª–æ–≤ –Ω–µ –≤–Ω–æ—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥.
- –ï—Å–ª–∏ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –ë–î, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏—à—å –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ XML-—Ñ–∞–π–ª—ã.

Hibernate –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –°–£–ë–î: MySQL, Oracle, PostgreSQL, Microsoft SQL Server Database, HSQL, DB2.  
Hibernate —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å–≤—è–∑–∫–µ —Å —Ç–∞–∫–∏–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏, –∫–∞–∫ Maven –∏ J2EE.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Hibernate (–≤ –∫—Ä–∞–π–Ω–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏) –∏–º–µ–µ—Ç —Ç–∞–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

[![arch](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/arch-768x597.jpg?resize=700%2C544)](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/arch.jpg)

–ï—Å–ª–∏ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–∞–º–æ–≥–æ Hibernate –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ, —á—Ç–æ —ç—Ç–æ—Ç –∂–µ —Ä–∏—Å—É–Ω–æ–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

[![hibArchDetailed](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibArchDetailed-1-768x614.jpg?resize=700%2C560)](https://i0.wp.com/proselyte.net/wp-content/uploads/2016/02/hibArchDetailed-1.jpg)

–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Ç–¥–µ–ª—å–Ω–æ –∫–∞–∂–¥—ã–π –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ Hibernate, –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑–∞–Ω—ã –≤ —Å—Ö–µ–º–µ:

**Transaction**

–≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–±–æ—á—É—é –µ–¥–∏–Ω–∏—Ü—É —Ä–∞–±–æ—Ç—ã —Å –ë–î. –í Hibernate —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

**SessionFactory**

–°–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∏ —Å–∞–º—ã–π —Ç—è–∂—ë–ª—ã–π –æ–±—ä–µ–∫—Ç (–æ–±—ã—á–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ, –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è). –ù–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ SessionFactory –¥–ª—è –∫–∞–∂–¥–æ–π –ë–î, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º.

**Session**

–°–µ—Å—Å–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î. –û–±—ã—á–Ω–æ, —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –∞ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —ç—Ç–∏ –æ–±—ä–µ–∫—Ç—ã –∫—Ä–∞–π–Ω–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ, –º–æ–¥–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç Session.

**Query**

–≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HQL –∏–ª–∏ SQL –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑/–≤ –ë–î. –≠–∫–∑–µ–º–ø–ª—è—Ä –∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.

**Configuration**

–≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ SessionFactory –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç —Å–∞–º Hibernate —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ XML-—Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç Session.

**Criteria**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤.



## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SessionFactory
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è: https://javarush.com/quests/lectures/questhibernate.level09.lecture02
https://javarush.com/quests/lectures/questhibernate.level09.lecture04



**Session** - —ç—Ç–æ —Ç–∞–∫–æ–π –∞–Ω–∞–ª–æ–≥ Connection 
**SessionFactory** - —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ Connection Pool

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª hibernate. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞–π—Ç–∏ –≤ Modules –∏ –¥–æ–±–∞–≤–∏—Ç—å Hibernate, –∞ –ø–æ—Ç–æ–º –≤ —Å–∞–º–æ–º –º–æ–¥—É–ª–µ Hibernate –Ω–∞–∂–∞—Ç—å "+" –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª.
–í–æ—Ç –∫–∞–∫ –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª:
```
<?xml version='1.0' encoding='utf-8'?>  
<!DOCTYPE hibernate-configuration PUBLIC  
    "-//Hibernate/Hibernate Configuration DTD//EN"  
    "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">  
<hibernate-configuration>  
  <session-factory>  
    <property name="connection.url">jdbc:postgresql://localhost:5432/university</property>  
    <property name="connection.username">maxim</property>  
    <property name="connection.password">3maxim14</property>  
    <property name="connection.driver_class">org.postgresql.Driver</property>  
    <property name="hibernate.dialect">org.hibernate.dialect.PostgreSQL10Dialect</property>  
  
  
    <!-- DB schema will be updated if needed -->  
    <!-- <property name="hibernate.hbm2ddl.auto">update</property> -->  </session-factory>  
</hibernate-configuration>
```



#### –°–æ–∑–¥–∞–Ω–∏–µ SessionFactory:
```java
Configuration configuration = new Configuration();  
configuration.configure();  
try (SessionFactory sessionFactory = configuration.buildSessionFactory();  
     Session session = sessionFactory.openSession()) {  
    System.out.println("OK");  
}
```

`Configuration` - –∫–ª–∞—Å—Å –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SessionFactory
`configure()` - –º–µ—Ç–æ–¥ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
`buildSessionFactory()` - –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SessionFactory
`openSession()` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ Session



#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ xml-—Ñ–∞–π–ª–∞ hibernate:

**hibernate.dialect**

–£–∫–∞–∑—ã–≤–∞–µ—Ç HIebrnate –¥–∏–∞–ª–µ–∫—Ç –ë–î. Hibernate, –≤ —Å–≤–æ–± –æ—á–µ—Ä–µ–¥—å, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, org.hibernate.dialect.MySQLDialect, –µ—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º MySQL).

**hibernate.connection-driver_class**

–£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å JDBC –¥—Ä–∞–π–≤–µ—Ä–∞.

**hibernate.connection.url**

–£–∫–∞–∑—ã–≤–∞–µ—Ç URL (—Å—Å—ã–ª–∫—É) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –Ω–∞–º –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, jdbc:mysql://localhost:3306/database).

**hibernate.connection.username**

–£–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, root).

**hibernate.connection.password**

–£–∫–∞—â—ã–≤–∞–µ—Ç –ø–∞—Ä–æ–ª—å –∫ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, password).

**hibernate.connection.pool_size**

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—É–ª–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π Hibernate.

**hibernate.connection.autocommit  
**–£–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∂–∏–º autocommit –¥–ª—è JDBC-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.






## Entity


–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã —ç–∫–∑–µ–º–ø–ª—è—Ä—ã (–æ–±—ä–µ–∫—Ç—ã) Java-–∫–ª–∞—Å—Å–∞ –≤ –±—É–¥—É—â–µ–º —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –ë–î, —Ç–æ –º—ã –Ω–∞–∑—ã–≤–∞–µ–º –∏—Ö ‚Äú—Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ –∫–ª–∞—Å—Å—ã‚Äù (persistent class). –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å Hibernate –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–æ–±–Ω–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π, –º—ã —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—É—é –º–æ–¥–µ–ª—å –ü—Ä–æ—Å—Ç—ã—Ö –°—Ç–∞—Ä—ã—Ö Java –û–±—ä–µ–∫—Ç–æ–≤ (Plain Old Java Object ‚Äì POJO).

–°—É—â–µ—Å—Ç–≤—É—é—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ POJO –∫–ª–∞—Å—Å–∞–º. –í–æ—Ç —Å–∞–º—ã–µ –≥–ª–∞–≤–Ω—ã–µ –∏–∑ –Ω–∏—Ö:

- –í—Å–µ –∫–ª–∞—Å—Å—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å ID –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ë–î –∏ –≤ Hibernate. –≠—Ç–æ –ø–æ–ª–µ –∫–ª–∞—Å—Å–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å –ø–µ—Ä–≤–∏—á–Ω—ã–º –∫–ª—é—á–æ–º (primary key) —Ç–∞–±–ª–∏—Ü—ã –ë–î.
- –í—Å–µ POJO ‚Äì –∫–ª–∞—Å—Å—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø—É—Å—Ç–æ–π).
- –í—Å–µ –ø–æ–ª—è POJO ‚Äì –∫–ª–∞—Å—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–∞¬†**private**¬†–∏–º–µ—Ç—å –Ω–∞–±–æ—Ä getter-–æ–≤ –∏ setter-–æ–≤ –≤ —Å—Ç–∏–ª–µ JavaBean.
- POJO ‚Äì –∫–ª–∞—Å—Å—ã –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.


–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ Hibernate —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ –∫–∞–∫ –∏ –≤ JDBC.
–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏:

```java
@Data  
@NoArgsConstructor  
@AllArgsConstructor  
@Builder  
@Entity  
@Table(name = "test", schema="public")  
public class Test {  
    @Id  
    private Long id;  
    private String reason;  
    private String annotation;  
}
```

`@Data` - —ç—Ç–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è lombok –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–µ—Ç—Ç–µ—Ä—ã, —Å–µ—Ç—Ç–µ—Ä—ã –∏ —Ç–¥
`@NoArgsConstructor` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
`@AllArgsConstructor` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–æ –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
`@Builder` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç builder –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏
`@Entity` - –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–µ—á–∞–µ—Ç —á—Ç–æ –¥–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å - —ç—Ç–æ —Å—É—â–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
`Table(name = "test", schema="public")` - –∑–¥–µ—Å—å —è –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—Ç–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã


–ß—Ç–æ–±—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–ª–∞ –∫–ª–∞—Å—Å –Ω—É–∂–Ω–æ –µ–≥–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```
<mapping class="org.main.entity.Test"/>
```


–†–∞–±–æ—Ç–∞ —Å —Å—É—â–Ω–æ—Å—Ç—å—é:
```java
Configuration configuration = new Configuration();  
configuration.setPhysicalNamingStrategy(new CamelCaseToUnderscoresNamingStrategy());  
configuration.configure();  
try (SessionFactory sessionFactory = configuration.buildSessionFactory();  
     Session session = sessionFactory.openSession()) {  
    session.beginTransaction();  
    Test builder = Test.builder()  
            .id(1L)  
            .reason("Test reason")  
            .annotation("Test annotation")  
            .build();  
    session.save(builder);  
    session.getTransaction().commit();  
}
```

`configuration.setPhysicalNamingStrategy(new CamelCaseToUnderscoresNamingStrategy()); ` - –¥–µ–ª–∞–µ—Ç —Ç–∞–∫ —á—Ç–æ–±—ã –≤—Å–µ –ø–æ–ª—è –≤ —Å—É—â–Ω–æ—Å—Ç–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–ª–∏—Å—å –≤ camel_case. –õ–∏–±–æ –Ω—É–∂–Ω–æ –Ω–∞–¥ –∫–æ–ª–æ–Ω–∫–æ–π –Ω–∞–ø–∏—Å–∞—Ç—å:
`@Column(name="birth_date")` –∫ –ø—Ä–∏–º–µ—Ä—É

`session.beginTransaction();` - –Ω–∞—á–∞–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```java
Test builder = Test.builder()  
            .id(1L)  
            .reason("Test reason")  
            .annotation("Test annotation")  
            .build();
```
—Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Å—É—â–Ω–æ—Å—Ç–∏

`session.save(builder);` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞:
```sql
insert 
    into
        public.test
        (annotation, reason, id) 
    values
        (?, ?, ?)
```

`session.getTransaction().commit();` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏


### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
–û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ç–∞–∫–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
```java
–ö–ª–∞—Å—Å –∏–º—è = session.get(–ö–ª–∞—Å—Å.class, ID);
```

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥–∞ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ id:
```java
public User getUserById(Integer id) { 
	try (Session session = sessionFactory.openSession()) { 
		User user = session.get(User.class, id); 
		return user; 
	}
}
```



### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ) –æ–±—ä–µ–∫—Ç–æ–≤

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–π –æ–±—ä–µ–∫—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ç–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞–ø—Ä–æ—Å¬†==INSERT==. –ü–æ—ç—Ç–æ–º—É —Ç–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥¬†`persist()`¬†–æ–±—ä–µ–∫—Ç–∞¬†**session**.

–û–±—â–∏–π –≤–∏–¥ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
```java
session.persist(–û–±—ä–µ–∫—Ç);
```

–ú–µ—Ç–æ–¥¬†`persist()`¬†–º–µ–Ω—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –±–∞–∑—É, –Ω–æ –∏ —Å–∞–º –æ–±—ä–µ–∫—Ç. –í—Å–µ –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–≥–¥–∞ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—ä–µ–∫—Ç –≤ –±–∞–∑—É, —Ç–æ –¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –µ—â–µ –Ω–µ—Ç —Å–≤–æ–µ–≥–æ¬†**ID**. –ù—É, –æ–±—ã—á–Ω–æ —Ç–∞–∫, —Ö–æ—Ç—è –±—ã–≤–∞—é—Ç –Ω—é–∞–Ω—Å—ã. –ê –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É –æ–±—ä–µ–∫—Ç–∞¬†**ID**¬†—É–∂ –µ—Å—Ç—å.

```java
public boolean saveUser(User user) {
    try (Session session = sessionFactory.openSession()) {
            Transaction transaction = session.beginTransaction();
            session.persist(user);
            transaction.commit();
            return true;
    }
    catch() {
    return false;
   	}
}
```

–¢–∞–∫–∂–µ —É –æ–±—ä–µ–∫—Ç–∞¬†**Session**¬†–µ—Å—Ç—å –º–µ—Ç–æ–¥¬†`save()`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –ü—Ä–æ—Å—Ç–æ –º–µ—Ç–æ–¥¬†`save()`¬†‚Äî —ç—Ç–æ —Å—Ç–∞—Ä—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç Hibernate, –∞ –º–µ—Ç–æ–¥¬†`persist()`¬†‚Äî —ç—Ç–æ JPA-—Å—Ç–∞–Ω–¥–∞—Ä—Ç.


### –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –æ–±—ä–µ–∫—Ç, —Ç–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ. –î–ª—è —ç—Ç–æ–≥–æ —É –æ–±—ä–µ–∫—Ç–∞ session –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ ‚Äî¬†`remove()`.

–û–±—â–∏–π –≤–∏–¥ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
```java
session.remove(–û–±—ä–µ–∫—Ç);
```

–ü—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥–∞:
```java
public boolean removeUser(User user) {
    try (Session session = sessionFactory.openSession()) {
            Transaction transaction = session.beginTransaction();
            session.remove(user);
            transaction.commit();
            return true;
    }
    catch() {
    return false;
   	}
}
```




## Type Converters


Hibernate —Å–∞–º —É–º–µ–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ù–æ —Ç–æ–ª—å–∫–æ —Ç–µ –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –Ω–µ–º. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `UserType`

–ö–æ–≥–¥–∞ —Ç—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –æ–±—ä–µ–∫—Ç—ã Java (–Ω–∞–ø—Ä–∏–º–µ—Ä, `User`, `Order`, `Product`) –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, Hibernate **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–µ—Ä–µ–≤–æ–¥–∏—Ç Java-–æ–±—ä–µ–∫—Ç—ã –≤ SQL-—Ñ–æ—Ä–º–∞—Ç (–∏ –æ–±—Ä–∞—Ç–Ω–æ).

–ù–æ –±—ã–≤–∞–µ—Ç, —á—Ç–æ **Hibernate –Ω–µ –∑–Ω–∞–µ—Ç**, –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫–æ–π-—Ç–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `enum`, `LocalDate`, `List<String>` –∏ —Ç.–¥.).

–¢—É—Ç –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥—è—Ç **Type Converters** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± **—Å–∫–∞–∑–∞—Ç—å Hibernate, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–≤–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É –∏ –æ–±—Ä–∞—Ç–Ω–æ.**



–ü—Ä–∏–º–µ—Ä —Å Enum:
```java
public enum Role {
    USER,
    ADMIN
}
```
–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—É—â–Ω–æ—Å—Ç–∏:
```java
@Entity
public class User {

    @Id
    private Long id;

    @Enumerated(EnumType.STRING)
    private Role role;

    // –≥–µ—Ç—Ç–µ—Ä—ã –∏ —Å–µ—Ç—Ç–µ—Ä—ã
}
```

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `@Enumerated(EnumType.STRING)`?

üëâ –û–Ω –≥–æ–≤–æ—Ä–∏—Ç Hibernate: "–°–æ—Ö—Ä–∞–Ω—è–π enum –∫–∞–∫ **—Å—Ç—Ä–æ–∫—É** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö".

- –¢–æ –µ—Å—Ç—å –≤ –±–∞–∑–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è `USER` –∏–ª–∏ `ADMIN`, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ.

#### Type
`@Type` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ç—ã —Ö–æ—á–µ—à—å **—Å–¥–µ–ª–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∏–ø–∞**, –∫–æ—Ç–æ—Ä—ã–π Hibernate —Å–∞–º –Ω–µ —É–º–µ–µ—Ç.

–ù–∞–ø—Ä–∏–º–µ—Ä:
```java
@Type(type = "json")
private Map<String, Object> settings;
```
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å **–∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–∏–ø**, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –ø–∏—à–µ—à—å –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—à—å.  
–ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å Map –≤ JSON –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL.


#### üî® –ê –µ—Å–ª–∏ –º–Ω–µ –Ω–∞–¥–æ —Å–∞–º–æ–º—É –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä?

–¢—ã –º–æ–∂–µ—à—å —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç `AttributeConverter`:
```java
@Converter
public class RoleConverter implements AttributeConverter<Role, String> {

    @Override
    public String convertToDatabaseColumn(Role role) {
        return role.name();
    }

    @Override
    public Role convertToEntityAttribute(String dbData) {
        return Role.valueOf(dbData);
    }
}
```
`Role` - —ç—Ç–æ Java-—Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ SQL-—Ç–∏–ø
`String` - —ç—Ç–æ SQL-—Ç–∏–ø –≤ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å

–õ–∏–±–æ –≤–æ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
![[Pasted image 20250405205404.png]]


–ê –ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫:
```java
@Convert(converter = RoleConverter.class)
private Role role;
```


–ß—Ç–æ–±—ã –Ω–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∏—Å–∞—Ç—å `@Convert` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∞—Å—Å –∫–æ—Ç–æ—Ä—ã–π –º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º:
```java
configuration.addAttributeConverter(new BirthDayConverter(), true);
```

–õ–∏–±–æ –Ω–∞–¥ —Å–∞–º–∏–º –∫–ª–∞—Å—Å–æ–º –ø—Ä–æ–ø–∏—Å–∞—Ç—å:
```
@Converter(autoApply=true)
```



–ù–æ –∏–Ω–æ–≥–¥–∞ –±—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–æ–≥–¥–∞ `AttributeConverter` –Ω–∞–º –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–º–æ—á—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤ SQL –Ω–µ—Ç —Ç–æ–≥–æ —Ç–∏–ø–∞ –≤ –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ö–æ—Ç–∏–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä JSON). –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å `Type` –∏–ª–∏ –ª—É—á—à–µ `UserType`. –ù–æ —Ç–∞–º –≤—Å–µ —Ç–∞–∫–∏ –º–Ω–æ–≥–æ –º–µ—Ç–æ–¥–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å. 
–ù–æ –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `Hibernate Types`

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞–¥ –ø–æ–ª–µ–º –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é `Type`:
`@Type(type = "–ø—É—Ç—å/–∫/–±–∏–±–ª–∏–æ—Ç–µ–∫–µ")`

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ jSON —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª–∞—Å—Å `JsonStringType` –∏–ª–∏ `JsonBinaryType`

–ê –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø –≤ configuration:
```java
configuration.registerTypeOverride(new JsonBinaryType());
```




## –ú–µ—Ç–æ–¥—ã update, delete, get


`update(user)` - –¥–µ–ª–∞–µ—Ç UPDATE –∑–∞–ø—Ä–æ—Å, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç Exception
`saveOrUpdate()` - —Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ `update()`, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç –≤ –±–∞–∑–µ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
`delete()` - —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç —Ç–æ –Ω–µ –±—É–¥–µ—Ç –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
`get(name|type, id)` - –¥–µ–ª–∞–µ—Ç SELECT –∑–∞–ø—Ä–æ—Å –ø–æ id:
```java
session.get(User.type, 3L);
```




## Entity Persister


![[Pasted image 20250407174027.png]]


**Entity Persister**. –≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Hibernate, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–º, –∫–∞–∫ —Å—É—â–Ω–æ—Å—Ç–∏ (Java-–∫–ª–∞—Å—Å—ã, –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–∫ `@Entity`) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç.

### 1. –ß—Ç–æ —Ç–∞–∫–æ–µ **Entity** –≤ Hibernate?

**Entity** ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å –≤ Java, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤ —Ç–∞–±–ª–∏—Ü–µ. –í Hibernate, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫–ª–∞—Å—Å —Å—É—â–Ω–æ—Å—Ç—å—é, –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ `@Entity`. –ù–∞–ø—Ä–∏–º–µ—Ä:
```java
@Entity
public class Test {
    @Id
    private Long id;
    private String reason;
    private String annotation;

    // –ì–µ—Ç—Ç–µ—Ä—ã –∏ —Å–µ—Ç—Ç–µ—Ä—ã
}
```
–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∫–ª–∞—Å—Å `Test` ‚Äî —ç—Ç–æ —Å—É—â–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –º–∞–ø–ø–∏—Ç—å—Å—è –Ω–∞ —Ç–∞–±–ª–∏—Ü—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

### 2. –ß—Ç–æ —Ç–∞–∫–æ–µ **Entity Persister**?

**Entity Persister** ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º–∞ Hibernate, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å **–ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–∞** –æ–±—ä–µ–∫—Ç–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ—Ü–µ—Å—Å "–ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–∞" –æ–∑–Ω–∞—á–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–æ–≤ Java. Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister`, —á—Ç–æ–±—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã Java –≤ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Ç—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –∏–ª–∏ –∏–∑–≤–ª–µ–∫–∞–µ—à—å —Å—É—â–Ω–æ—Å—Ç–∏, **Entity Persister** –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É –ø–æ –º–∞–ø–ø–∏–Ω–≥—É —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç **Entity Persister**?

–ö–æ–≥–¥–∞ —Ç—ã –≤—ã–∑—ã–≤–∞–µ—à—å –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏, Hibernate –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ `Entity Persister`, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

#### 1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**:

–ö–æ–≥–¥–∞ —Ç—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –æ–±—ä–µ–∫—Ç —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `session.save()` –∏–ª–∏ `session.persist()`, Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±—ä–µ–∫—Ç–∞ –≤ SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É.

–ü—Ä–∏–º–µ—Ä:
```java
Session session = sessionFactory.openSession();
session.beginTransaction();

Test test = new Test();
test.setId(1L);
test.setReason("Some reason");
test.setAnnotation("Some annotation");

session.save(test);
session.getTransaction().commit();
session.close();
```

- Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister`, —á—Ç–æ–±—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç `test` –≤ SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—É `test` –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

#### 2. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–Ω–æ—Å—Ç–∏**:

–ö–æ–≥–¥–∞ —Ç—ã –∑–∞–≥—Ä—É–∂–∞–µ—à—å –æ–±—ä–µ–∫—Ç —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `session.get()` –∏–ª–∏ `session.load()`, Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –æ–±—ä–µ–∫—Ç Java.

–ü—Ä–∏–º–µ—Ä:
```java
Session session = sessionFactory.openSession();
Test test = session.get(Test.class, 1L);
session.close();
```

- Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister`, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `SELECT * FROM test WHERE id = 1`) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–±—ä–µ–∫—Ç `Test`.
    

#### 3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**:

–ö–æ–≥–¥–∞ —Ç—ã –æ–±–Ω–æ–≤–ª—è–µ—à—å –æ–±—ä–µ–∫—Ç —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `session.update()` –∏–ª–∏ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, Hibernate —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister`, —á—Ç–æ–±—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

#### 4. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**:

–ö–æ–≥–¥–∞ —Ç—ã —É–¥–∞–ª—è–µ—à—å –æ–±—ä–µ–∫—Ç —Å –ø–æ–º–æ—â—å—é `session.delete()`, Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

### 4. –ö–∞–∫ Hibernate —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å—É—â–Ω–æ—Å—Ç—è–º–∏ —á–µ—Ä–µ–∑ **Entity Persister**?

Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:

- –ò–º—è —Ç–∞–±–ª–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –º–∞–ø–ø–∏—Ç—Å—è —Å—É—â–Ω–æ—Å—Ç—å.
    
- –°—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è–º –∫–ª–∞—Å—Å–∞.
    
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (`@Id`), –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤–∏—á–Ω—ã–º –∫–ª—é—á–æ–º.
    
- –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
    

–ö–æ–≥–¥–∞ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π, Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister` –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è, –∫–∞–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —ç—Ç–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π. –î–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ Hibernate —Å–æ–∑–¥–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `Entity Persister`, –∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞–µ—Ç, –∫–∞–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ –æ–±—Ä–∞—Ç–Ω–æ.

### 5. –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å **Entity Persister**

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É —Ç–µ–±—è –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—É—â–Ω–æ—Å—Ç—å `Test`:
```java
@Entity
@Table(name = "test")
public class Test {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String reason;
    private String annotation;
    // –ì–µ—Ç—Ç–µ—Ä—ã –∏ —Å–µ—Ç—Ç–µ—Ä—ã
}
```

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —Ç—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ—à—å –æ–±—ä–µ–∫—Ç `Test` —Å –ø–æ–º–æ—â—å—é Hibernate, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```java
Session session = sessionFactory.openSession();
Test test = session.get(Test.class, 1L);
```

Hibernate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Entity Persister` –¥–ª—è:

1. –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–∞ `SELECT * FROM test WHERE id = 1`.
    
2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –æ–±—ä–µ–∫—Ç `Test`.
    

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —Ö—Ä–∞–Ω—è—â–µ–π—Å—è –≤ –∫–ª–∞—Å—Å–µ `Test`. `Entity Persister` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–æ–ª—è–º –∫–ª–∞—Å—Å–∞.

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Entity Persister** ‚Äî —ç—Ç–æ –≤–∞–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Hibernate, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π. –û–Ω –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è —Ä–∞–±–æ—Ç—É –ø–æ –º–∞–ø–ø–∏–Ω–≥—É –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ Java –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –æ–±–ª–µ–≥—á–∞—è —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –Ω–∞ Hibernate.

–ö–æ–≥–¥–∞ —Ç—ã –Ω–∞—á–∏–Ω–∞–µ—à—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å Hibernate, –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `Entity Persister`, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã ORM (–æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è) –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.



## First Level Cache


`evict(user)` - –º–µ—Ç–æ–¥ —É Session –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å –∏–∑ persistance context
`session.clear()` - –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à

–£ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ –µ—Å—Ç—å —Å–≤–æ–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫—ç—à
–ß—Ç–æ–±—ã —Å—É—â–Ω–æ—Å—Ç—å –ø–æ–ø–∞–ª–∞ –≤ persistence context (–∫—ç—à) –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö




## Entity Lifecycle

–õ–µ–∫—Ü–∏—è: https://javarush.com/quests/lectures/questhibernate.level11.lecture00


![[Pasted image 20250407180352.png]]




–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏:
```java
@UtilityClass  
public class HibernateUtil {  
    public static SessionFactory getSessionFactory() {  
        Configuration configuration = new Configuration();  
        configuration.setPhysicalNamingStrategy(new CamelCaseToUnderscoresNamingStrategy());  
        configuration.configure();  
        return configuration.buildSessionFactory();  
    }  
}
```


`refresh(user)` - –º–µ—Ç–æ–¥ —É session, –∫–æ—Ç–æ—Ä—ã–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç –≤ java c –æ–±—ä–µ–∫—Ç–æ–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö


![](https://cdn.javarush.com/images/article/d79ec4c4-75c1-4ae4-b7c9-8672e38dee58/1024.webp)


### Transient

–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ POJO –æ–±—ä–µ–∫—Ç –≤ Java. –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –Ω–µ–º –Ω–∏–∫–∞–∫ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

–ï—Å–ª–∏ –Ω–µ–∫–∏–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±—ä–µ–∫—Ç–æ–º —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º Transient, —Ç–æ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Å—É–ø–µ—Ä-–ø—Ä–æ—Å—Ç–æ–π —Å—Ö–µ–º–æ–π:

![](https://cdn.javarush.com/images/article/53224fad-6579-4469-845a-0f1bb13e9a86/256.webp)


### Persistent

–°–ª–µ–¥—É—é—â–∏–π —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π ‚Äì —ç—Ç–æ –æ–±—ä–µ–∫—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–≤–∏–∂–∫–æ–º Hibernate. –ò—Ö —Å—Ç–∞—Ç—É—Å –Ω–∞–∑—ã–≤–∞—é—Ç Persistent (–∏–ª–∏ –∂–µ Managed). –°–ø–æ—Å–æ–±–æ–≤ –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç —Å —Ç–∞–∫–∏–º —Å—Ç–∞—Ç—É—Å–æ–º —Ä–æ–≤–Ω–æ –¥–≤–∞:

- –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—ä–µ–∫—Ç –∏–∑ Hibernate.
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç –≤ Hibernate.


–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞ –∏ –æ–±—ä–µ–∫—Ç–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ Managed –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –≤–æ—Ç —Ç–∞–∫–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π:

![](https://cdn.javarush.com/images/article/a3dbbcc1-397b-4695-954b-5c52073850ba/800.webp)

### Detached

–°–ª–µ–¥—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äì —ç—Ç–æ –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –±—ã–ª –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω –æ—Ç —Å–µ—Å—Å–∏–∏. –¢–æ –µ—Å—Ç—å –∫–æ–≥–¥–∞-—Ç–æ –æ–±—ä–µ–∫—Ç –±—ã–ª –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω –∫ —Å–µ—Å—Å–∏–∏ Hibernate, –Ω–æ –∑–∞—Ç–µ–º —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –∏–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å, –∏ Hibernate –±–æ–ª—å—à–µ –Ω–µ —Å–ª–µ–¥–∏—Ç –∑–∞ —ç—Ç–∏–º –æ–±—ä–µ–∫—Ç–æ–º.

–ù–æ–≤–∞—è —Å—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–∞ –∏ –æ–±—ä–µ–∫—Ç–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

![](https://cdn.javarush.com/images/article/cd4dfefa-63c3-4026-b48a-b7b2cf5b95e0/800.webp)



## Java Persistence API (JPA)


![[Pasted image 20250407182123.png]]






## Logging


![[Pasted image 20250407235620.png]]



–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–≥–µ—Ä–∞:
```java
private static final Logger logger = LoggerFactory.getLogger(Main.class);
```

–ò –ø—Ä–∏–º–µ—Ä –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
```java
logger.info("..{}..", arg);
```


–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ log4f.xml:
```xml
<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">  
  
<log4j:configuration>  
  
    <!-- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∞–ø–ø–µ–Ω–¥–µ—Ä -->  
    <appender name="console" class="org.apache.log4j.ConsoleAppender">  
        <layout class="org.apache.log4j.PatternLayout">  
            <param name="ConversionPattern" value="%d{ISO8601} [%t] %-5p %c - %m%n"/>  
        </layout>  
    </appender>  
  
    <!-- –§–∞–π–ª–æ–≤—ã–π –∞–ø–ø–µ–Ω–¥–µ—Ä -->  
    <appender name="fileAppender" class="org.apache.log4j.RollingFileAppender">  
        <param name="File" value="logs/app.log"/>  
        <param name="MaxFileSize" value="10MB"/>  
        <param name="MaxBackupIndex" value="5"/>  
        <layout class="org.apache.log4j.PatternLayout">  
            <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n"/>  
        </layout>  
    </appender>  
  
    <!-- –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->  
    <root>  
        <priority value="debug"/>  
        <appender-ref ref="console"/>  
        <appender-ref ref="fileAppender"/>  
    </root>  
  
    <!-- –ü—Ä–∏–º–µ—Ä: –¥–ª—è –ª–æ–≥–≥–µ—Ä–∞ Hibernate -->  
    <logger name="org.hibernate" additivity="false">  
        <level value="warn"/>  
    </logger>  
    <logger name="org.main" additivity="false">  
        <level value="info"/>  
    </logger>  
  
</log4j:configuration>
```





## Embedded Components


**Embedded component** (–≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç) ‚Äî —ç—Ç–æ **–Ω–µ–æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å**, –∫–æ—Ç–æ—Ä—É—é —Ç—ã **–≤—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å –≤ –¥—Ä—É–≥—É—é —Å—É—â–Ω–æ—Å—Ç—å** –∫–∞–∫ —á–∞—Å—Ç—å –µ—ë –ø–æ–ª–µ–π.

–û–Ω–∞:

- **–Ω–µ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ID** (–Ω–µ @Entity),
    
- **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–æ–π –∂–µ —Ç–∞–±–ª–∏—Ü–µ**, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å,
    
- –ø—Ä–æ—Å—Ç–æ –∫–∞–∫ **–≥—Ä—É–ø–ø–∞ –ø–æ–ª–µ–π**, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –≤ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç.


### üß† –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

–ö–æ–≥–¥–∞ —É —Ç–µ–±—è –µ—Å—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π**, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–º–µ—Å—Ç–µ ‚Äî —É–¥–æ–±–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏—Ö –≤ **–æ–¥–∏–Ω –∫–ª–∞—Å—Å**. –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç:

- **—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞** (—É–¥–æ–±–Ω–µ–µ —á–∏—Ç–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å),
    
- **–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** (–º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ —Ä–∞–∑–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏),
    
- **–ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏** (–ª–æ–≥–∏—á–µ—Å–∫–∏ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).


–ü—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞–Ω–∏–µ emdedded –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ Test –¥–ª—è –ø–æ–ª–µ–π reason –∏ annotation:
```java
@Data  
@NoArgsConstructor  
@AllArgsConstructor  
@Builder  
@Embeddable  
public class TestInfo {  
    private String reason;  
    private String annotation;  
}
```

–°–∞–º –∫–ª–∞—Å—Å —Ç–µ—Å—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è —Ç–∞–∫:
```java
@Data  
@NoArgsConstructor  
@AllArgsConstructor  
@Builder  
@Entity  
@Table(name = "test", schema="public")  
public class Test {  
    @Id  
    private Long id;  
    @Embedded  
    private TestInfo testInfo;  // embedded component
}
```

–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞:
```java
Test builder = Test.builder()  
        .id(38320L)  
        .testInfo(TestInfo.builder()  // embedded component
                .reason("Test reason 2")  
                .annotation("Test annotation 2")  
                .build())  
        .build();
```




## Primary Keys


–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è Primary Key:
```java
@Id  
@GeneratedValue(strategy = GenerationType.IDENTITY)  
private Long id;
```

–ò –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å id –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∑–Ω–∞—á–µ–Ω–∏—è

`GenerationType.IDENTITY` - –¥–ª—è –ø–æ–ª–µ–π SERIAL
`GenerationType.SEQUENCE` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è sequence –µ—Å–ª–∏ –º—ã –∏—Ö —Å–æ–∑–¥–∞–µ–º. –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @SequenceGenerator
`GenerationType.TABLE` - –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—É —Å sequences –≥–¥–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –∫–∞–∫ PRIMARY KEY –∏ id —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã. –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @TableGenerator








# Mapping entity assiciations

## Mapping –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è: https://javarush.com/quests/lectures/questhibernate.level12.lecture03
–∏ 
https://javarush.com/quests/lectures/questhibernate.level12.lecture04


–í –Ω—ã–Ω–µ—à–Ω–µ–µ –≤—Ä–µ–º—è —Å –º–∞–ø–ø–∏–Ω–≥–æ–º –≤—Å–µ –æ–±—Å—Ç–æ–∏—Ç –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ –∏ –ª—É—á—à–µ. –í—Å–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç 4 —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º:

- **DATE**¬†‚Äì –¥–∞—Ç–∞: –≥–æ–¥, –º–µ—Å—è—Ü –∏ –¥–µ–Ω—å.
- **TIME**¬†‚Äì –≤—Ä–µ–º—è: —á–∞—Å—ã, –º–∏–Ω—É—Ç—ã, —Å–µ–∫—É–Ω–¥—ã.
- **TIMESTAMP**¬†‚Äì –¥–∞—Ç–∞, –≤—Ä–µ–º—è –∏ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥—ã.
- **TIMESTAMP WITH TIME ZONE**¬†‚Äì TIMESTAMP –∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ (–∏–º—è –∑–æ–Ω—ã –∏–ª–∏ —Å–º–µ—â–µ–Ω–∏–µ).

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å¬†**—Ç–∏–ø**¬†==DATE==¬†–≤ Java, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å¬†`java.time.LocalDate`¬†–∏–∑ JDK 8 DateTime API.

–¢–∏–ø¬†==TIME==¬†–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏ –∏–∑ Java:¬†`java.time.LocalTime`¬†–∏¬†`java.time.OffsetTime`. –ù–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ.

–ê —Ç–æ—á–Ω—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é —Ç–∏–ø–æ–º¬†==TIMESTAMP==¬†–≤ –±–∞–∑–µ, –≤ Java –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å 4 —Ç–∏–ø–∞–º–∏:

- **java.time.Instant**
- **java.time.LocalDateTime**
- **java.time.OffsetDateTime**
- **java.time.ZonedDateTime**

–ù—É –∏ –Ω–∞–∫–æ–Ω–µ—Ü¬†==TIMESTAMP WITH TIME ZONE==¬†–º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏:

- **java.time.OffsetDateTime**
- **java.time.ZonedDateTime**


## Mapping –∫–æ–ª–ª–µ–∫—Ü–∏–π

–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è `@EntityCollection`

–í—Å–µ –ø–æ–ª—è Entity-–∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏¬†@ElementCollection¬†—Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. –ß—Ç–æ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è, –ª–æ–≥–∏—á–Ω–æ.


–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥–≤—É—Ö –≤–∏–¥–∞—Ö:

- **–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ**¬†(List, Map) —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç—Ä–∏ –∫–æ–ª–æ–Ω–∫–∏:
    - **Key Column**¬†(Foreign Key) ‚Äì —Å—Å—ã–ª–∫–∞ –Ω–∞ ID –æ–±—ä–µ–∫—Ç–∞-—Ä–æ–¥–∏—Ç–µ–ª—è.
    - **Index Column**¬†‚Äì –ø–æ–∑–∏—Ü–∏—è/–∏–Ω–¥–µ–∫—Å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏.
    - **Element Column**¬†‚Äì –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ**¬†(Set) —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏:
    - **Key Column**¬†(Foreign Key) ‚Äì —Å—Å—ã–ª–∫–∞ –Ω–∞ ID –æ–±—ä–µ–∫—Ç–∞-—Ä–æ–¥–∏—Ç–µ–ª—è.
    - **Element Column**¬†‚Äì –∑–Ω–∞—á–µ–Ω–∏–µ.

–¢–∞–∫–∂–µ —Ç—ã –º–æ–∂–µ—à—å –∑–∞–¥–∞—Ç—å –∏–º—è —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã —è–≤–Ω–æ —Å –ø–æ–º–æ—â—å—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏:

```java
@CollectionTable(name="–∏–º—è_—Ç–∞–±–ª–∏—Ü—ã")
```

–ü—Ä–∏–º–µ—Ä:
```java
@Entity
@Table(name="user")
class User {
   @Id
   @Column(name="id")
   public Integer id;

   @ElementCollection
   @CollectionTable(name="user_message")
   public List<String> messages;
}
```

**–í–∞–∂–Ω–æ!**¬†–ï—Å–ª–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è¬†@CollectionTable¬†–Ω–µ —É–∫–∞–∑–∞–Ω–∞, —Ç–æ Hibernate —Å–∞–º –ø–æ—Å—Ç—Ä–æ–∏—Ç –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ –∫–ª–∞—Å—Å–∞ –∏ –∏–º–µ–Ω–∏ –ø–æ–ª—è: –∫–ª–∞—Å—Å¬†User¬†–∏ –ø–æ–ª–µ¬†==messages==¬†–¥–∞–¥—É—Ç –∏–º—è —Ç–∞–±–ª–∏—Ü–µ "User_messages".

## Many to one


–ü—Ä–∏–º–µ—Ä:
```java
@ManyToOne  
@JoinColumn(name="contract_type_id")  
private ContractTypes contractTypeId;
```
`@ManyToOne` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤—è–∑—å many to one
`@JoinColumn(name="contract_type_id")` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∞—è –∫–æ–ª–æ–Ω–∫–∞ –≤ –Ω–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è id –æ–±—ä–µ–∫—Ç–∞ ContractType
`private ContractTypes contractTypeId;` - –∑–¥–µ—Å—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–∏–ø —Å –∫–æ—Ç–æ—Ä–æ–π –∏–¥–µ—Ç —Å–≤—è–∑—å



## Fetch Types

https://javarush.com/quests/lectures/questhibernate.level14.lecture01


#### –ü—Ä–µ–¥—Å—Ç–∞–≤—å:

–¢—ã –ø–æ–ø—Ä–æ—Å–∏–ª Hibernate –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—ä–µ–∫—Ç `User` —Å id = 1. –ù–æ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º ‚Äî —É –Ω–µ–≥–æ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏, —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ —Ç.–¥. –ß—Ç–æ–±—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—ë —Å—Ä–∞–∑—É, Hibernate –º–æ–∂–µ—Ç "–æ–±–º–∞–Ω—É—Ç—å" —Ç–µ–±—è:

–û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–Ω–µ –Ω–∞—Å—Ç–æ—è—â–∏–π –æ–±—ä–µ–∫—Ç `User`**, –∞ **–ø—Ä–æ–∫—Å–∏** ‚Äî "–æ–±—ë—Ä—Ç–∫—É", –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `User`, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –¥–∞–Ω–Ω—ã–µ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ü—Ä–æ–∫—Å–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö **—Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ç—ã –∫ –Ω–∏–º –æ–±—Ä–∞—Ç–∏–ª—Å—è**.

### –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Lazy loading)**, –∏ Hibernate –¥–µ–ª–∞–µ—Ç —ç—Ç–æ —á–µ—Ä–µ–∑ **–ø—Ä–æ–∫—Å–∏**.

---

#### üß© –ü—Ä–∏–º–µ—Ä:
```java
User user = session.get(User.class, 1);
System.out.println(user.getName()); // –∑–¥–µ—Å—å Hibernate –º–æ–∂–µ—Ç –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ–∫—Å–∏
```
–ï—Å–ª–∏ `user` ‚Äî —ç—Ç–æ –ø—Ä–æ–∫—Å–∏, —Ç–æ –∫–æ–≥–¥–∞ —Ç—ã –≤—ã–∑—ã–≤–∞–µ—à—å `getName()`, Hibernate –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.



#### üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏?

Hibernate —Å–æ–∑–¥–∞—ë—Ç **–¥–æ—á–µ—Ä–Ω–∏–π –∫–ª–∞—Å—Å** –æ—Ç —Ç–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞ `User` –∏ –≤–Ω–µ–¥—Ä—è–µ—Ç —Ç—É–¥–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É. –ù–∞–ø—Ä–∏–º–µ—Ä:
```java
class UserProxy extends User {
    // –ø—Ä–∏ –≤—ã–∑–æ–≤–µ getName() Hibernate –¥–µ–ª–∞–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å
}
```



#### ‚ö†Ô∏è –ù–∞ —á—Ç–æ –Ω–æ–≤–∏—á–∫–∞–º —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ

1. **–ü—Ä–æ–±–ª–µ–º—ã –≤–Ω–µ —Å–µ—Å—Å–∏–∏:** –ï—Å–ª–∏ —Ç—ã –ø–æ–ª—É—á–∏—à—å –ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç, –Ω–æ —Å–µ—Å—Å–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ ‚Äî –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –¥–∞–Ω–Ω—ã–º –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞:
```java
LazyInitializationException: could not initialize proxy - no Session
```
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ instanceof:** –ü—Ä–æ–∫—Å–∏ ‚Äî —ç—Ç–æ –Ω–µ —Å–æ–≤—Å–µ–º `User`, –∞ `User$HibernateProxy`. –¢–∞–∫ —á—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ `instanceof` –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ.
    
3.  **–ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–∫—Å–∏:** –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å `@Proxy(lazy = false)` –∏–ª–∏ –≤ `@OneToMany(fetch = FetchType.EAGER)` ‚Äî —Ç–æ–≥–¥–∞ Hibernate –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ (–Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ!).


#### üß™ –í—ã–≤–æ–¥

Hibernate Proxy ‚Äî —ç—Ç–æ —Ö–∏—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã, –æ—Ç–∫–ª–∞–¥—ã–≤–∞—è –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –æ–Ω–∏ —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –ë–î, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç–∏.

–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–∏–º–µ—Ä —Å Lazy/Eager –∑–∞–≥—Ä—É–∑–∫–æ–π –∏ –ø—Ä–æ–∫—Å–∏ –≤ –∫–æ–¥–µ?




## Cascade Types


`@ManyToOne(cascade = CascadeType.DETACH)` - —Ç–∞–∫ –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –µ—Å–ª–∏ –º—ã —É–¥–∞–ª—è–µ–º —Å—É—â–Ω–æ—Å—Ç—å —Ç–æ –∏ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å —Ç–∞–∫–∂–µ —É–¥–∞–ª—è–µ—Ç—Å—è

`@ManyToOne(cascade = CascadeType.PERSIST)` - –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é —Å—É—â–Ω–æ—Å—Ç—å —Ç–æ –∏ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**Cascade (–∫–∞—Å–∫–∞–¥)** ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å Hibernate:

> "–≠–π, –µ—Å–ª–∏ —è —Å–¥–µ–ª–∞—é —á—Ç–æ-—Ç–æ —Å –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–¥–µ–ª–∞–π —Ç–æ –∂–µ —Å–∞–º–æ–µ –∏ —Å –µ–≥–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏!"

---

#### üîß –ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å–∏—Ç—É–∞—Ü–∏—é:

–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–≤–∞ –∫–ª–∞—Å—Å–∞
```java
@Entity
class User {
    @OneToOne(cascade = ???)
    private Profile profile;
}

@Entity
class Profile {
    // ...
}
```

–£ `User` –µ—Å—Ç—å `Profile`. –ï—Å–ª–∏ —Ç—ã —Å–æ—Ö—Ä–∞–Ω–∏—à—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ö–æ—á–µ—à—å –ª–∏ —Ç—ã **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—å**? –ï—Å–ª–∏ –¥–∞ ‚Äî —Ç–æ–≥–¥–∞ —Ç–µ–±–µ –Ω—É–∂–µ–Ω **cascade**.

---

#### üß© –ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç Cascade Types?

–í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –∫–∞—Å–∫–∞–¥–æ–≤:

|–¢–∏–ø|–ß—Ç–æ –¥–µ–ª–∞–µ—Ç|
|---|---|
|`PERSIST`|–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ (`save`) –≥–ª–∞–≤–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π.|
|`MERGE`|–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (`update`) –≥–ª–∞–≤–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π.|
|`REMOVE`|–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ (`delete`) –≥–ª–∞–≤–Ω–æ–≥–æ ‚Äî —É–¥–∞–ª—è–µ—Ç—Å—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π.|
|`REFRESH`|–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ –±–∞–∑—ã (`refresh`) ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π.|
|`DETACH`|–ü—Ä–∏ –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –æ—Ç —Å–µ—Å—Å–∏–∏ (`detach`) ‚Äî –æ—Ç—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π.|
|`ALL`|–í—Å—ë –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ.|

---

#### ‚úÖ –ü—Ä–∏–º–µ—Ä –≤ –∫–æ–¥–µ
```java
@OneToOne(cascade = CascadeType.ALL)
private Profile profile;
```
–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å:
```java
User user = new User();
Profile profile = new Profile();

user.setProfile(profile);
session.persist(user); // Hibernate —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∏ profile —Ç–æ–∂–µ!
```
–ë–µ–∑ –∫–∞—Å–∫–∞–¥–∞ —Ç–µ–±–µ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—Ä—É—á–Ω—É—é –≤—ã–∑—ã–≤–∞—Ç—å:
```java
session.persist(profile);
session.persist(user);
```


#### ‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å REMOVE

–ï—Å–ª–∏ —Ç—ã –¥–æ–±–∞–≤–∏—à—å `CascadeType.REMOVE`, —Ç–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ `User` —É–¥–∞–ª–∏—Ç—Å—è –∏ `Profile`. –≠—Ç–æ —É–¥–æ–±–Ω–æ, –Ω–æ **–æ–ø–∞—Å–Ω–æ**, –µ—Å–ª–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –¥—Ä—É–≥–∏–º –æ–±—ä–µ–∫—Ç–∞–º. –í—Å–µ–≥–¥–∞ –¥—É–º–∞–π: "–∞ –Ω–µ –ø–æ–ª–æ–º–∞—é –ª–∏ —è –±–∞–∑—É?"

---

#### üìå –ì–¥–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

- `@OneToOne`
    
- `@OneToMany`
    
- `@ManyToOne`
    
- `@ManyToMany`
    

---

#### üéì –ó–∞–ø–æ–º–Ω–∏ –ø—Ä–æ—Å—Ç–æ

**Cascade ‚Äî —ç—Ç–æ –∫–∞–∫ "—ç—Ñ—Ñ–µ–∫—Ç –¥–æ–º–∏–Ω–æ":** —Ç—ã –¥–µ–ª–∞–µ—à—å –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞–¥ –æ–¥–Ω–∏–º –æ–±—ä–µ–∫—Ç–æ–º, –∏ –æ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ, –µ—Å–ª–∏ —Ç—ã —É–∫–∞–∑–∞–ª –Ω—É–∂–Ω—ã–π —Ç–∏–ø –∫–∞—Å–∫–∞–¥–∞.





## OneToMany
https://javarush.com/quests/lectures/questhibernate.level13.lecture02




```java
@OneToMany(mappedBy = "company")
private List<User> users;
```
–ü—Ä–∏–º–µ—Ä OneToMany —Å–≤—è–∑–∏


–ê –≤ –∫–ª–∞—Å—Å–µ User –±—É–¥–µ—Ç —Ç–∞–∫–æ–π –∫–æ–¥:
```java
@Entity
public class User {
    @ManyToOne
    @JoinColumn(name = "company_id")
    private Company company;
}
```


### üß† –¢–µ–ø–µ—Ä—å –ø–æ —á–∞—Å—Ç—è–º:

#### üß© `@OneToMany`

Hibernate'—É –≥–æ–≤–æ—Ä–∏–º: "–≠—Ç–æ **–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º** ‚Äî –æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è, –º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π".

---

#### üß© `mappedBy = "company"`

–≠—Ç–æ **–∫–ª—é—á–µ–≤–∞—è —á–∞—Å—Ç—å**!

- `mappedBy = "company"` –≥–æ–≤–æ—Ä–∏—Ç Hibernate'—É:
    
    > "–ù–µ —Å–æ–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Å–≤—è–∑–∏. –°–≤—è–∑—å —É–∂–µ –æ–ø–∏—Å–∞–Ω–∞ –≤ –∫–ª–∞—Å—Å–µ `User` ‚Äî —Ç–∞–º –µ—Å—Ç—å –ø–æ–ª–µ `company`."
    
- –¢–æ –µ—Å—Ç—å: **–≤–ª–∞–¥–µ–ª–µ—Ü —Å–≤—è–∑–∏ ‚Äî `User`**, –∞ `Company` –ø—Ä–æ—Å—Ç–æ "–∑–µ—Ä–∫–∞–ª–∏—Ç" —ç—Ç—É —Å–≤—è–∑—å.
    

---

### üìä –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –ë–î?

- –¢–∞–±–ª–∏—Ü–∞ `user` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É `company_id`, –∫–æ—Ç–æ—Ä–∞—è —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ç–∞–±–ª–∏—Ü—É `company`.
    
- –¢–∞–±–ª–∏—Ü–∞ `company` **–Ω–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –Ω–∞–ø—Ä—è–º—É—é ‚Äî —ç—Ç–æ –ª–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–≤—è–∑–∏ –≤ Java-–∫–æ–¥–µ.





## Cascade types with collections


–î–æ–ø—É—Å—Ç–∏–º –µ—Å—Ç—å –∫–ª–∞—Å—Å Company:
```java
@OneToMany(mappedBy = "company", cascade = CascadeTypes.ALL)
private Set<User> users;


public void addUser(User user) {
	users.add(user);
	user.setCompany(this);
}
```

–ó–¥–µ—Å—å –µ—Å—Ç—å —Å–≤—è–∑—å –æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º –∏ –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CascadeTypes.ALL –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –µ—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–ø–∞–Ω–∏—é –∏ –≤ –Ω–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–ª—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É Users. 

–ò —Ç–∞–∫–∂–µ —è –¥–æ–±–∞–≤–∏–ª –º–µ—Ç–æ–¥ addUser –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É Users, –∞ —Ç–∞–∫–∂–µ —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –µ–º—É –∫–æ–º–ø–∞–Ω–∏—é



## Entity equals and hashcode

```java
@EqualsAndHashCode(of = "id")
@ToString(of = "id")
```
–¢–∞–∫ –º–µ—Ç–æ–¥—ã `equals` –∏ `hashCode` –±—É–¥—É—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –ø–æ id



## Many To Many
https://javarush.com/quests/lectures/questhibernate.level13.lecture03


–Ø –æ–ø—É—â—É –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è, –∑–∞—Ç–æ –¥–æ–±–∞–≤–ª—é –Ω–æ–≤—ã–µ. –í–æ—Ç –∫–∞–∫ –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å. –ö–ª–∞—Å—Å¬†Employee:

```java
@Entity
@Table(name="employee")
class Employee {
   @Column(name="id")
   public Integer id;

   @ManyToMany(cascade = CascadeType.ALL)
   @JoinTable(name="employee_task",
	       joinColumns=  @JoinColumn(name="employee_id", referencedColumnName="id"),
           inverseJoinColumns= @JoinColumn(name="task_id", referencedColumnName="id") )
   private Set<EmployeeTask> tasks = new HashSet<EmployeeTask>();

}
```


–ò –∫–ª–∞—Å—Å¬†EmployeeTask:

```java
@Entity
@Table(name="task")
class EmployeeTask {
   @Column(name="id")
   public Integer id;

   @ManyToMany(cascade = CascadeType.ALL)
   @JoinTable(name="employee_task",
       	joinColumns=  @JoinColumn(name="task_id", referencedColumnName="id"),
       	inverseJoinColumns= @JoinColumn(name=" employee_id", referencedColumnName="id") )
   private Set<Employee> employees = new HashSet<Employee>();

}
```

–í–æ-–ø–µ—Ä–≤—ã—Ö, —Ç–∞–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è¬†@JoinTable¬†(–Ω–µ –ø—É—Ç–∞—Ç—å —Å @JoinColumn), –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ª—É–∂–µ–±–Ω—É—é —Ç–∞–±–ª–∏—Ü—É employee_task.

–í–æ-–≤—Ç–æ—Ä—ã—Ö, —Ç–∞–º –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∞ task_id —Ç–∞–±–ª–∏—Ü—ã employee_task —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–ª–æ–Ω–∫—É id —Ç–∞–±–ª–∏—Ü—ã task.

–í-—Ç—Ä–µ—Ç—å–∏—Ö, —Ç–∞–º –≥–æ–≤–æ—Ä–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∞ employee_id —Ç–∞–±–ª–∏—Ü—ã employee_task —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–ª–æ–Ω–∫—É id —Ç–∞–±–ª–∏—Ü—ã employee.

–ú—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å –ø–æ–º–æ—â—å—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –æ–ø–∏—Å–∞–ª–∏ –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ employee_task –∏ –∫–∞–∫ Hibernate –¥–æ–ª–∂–µ–Ω –∏—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å.


## One To One
https://javarush.com/quests/lectures/questhibernate.level13.lecture04

–í —Å–ª—É—á–∞–µ –∂–µ —Å Entity-–∫–ª–∞—Å—Å–∞–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏:

- @Embedded
- –û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π OneToOne
- –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π OneToOne
- @MapsId




## HQL


### –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å HQL

–†–∞–Ω–µ–µ —Ç—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è —Å Hibernate, –∞ —Ç–µ–ø–µ—Ä—å —è –ø–æ–∑–Ω–∞–∫–æ–º–ª—é —Ç–µ–±—è —Å¬†**HQL**, –æ–Ω –∂–µ¬†**Hibernate Query Language**. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, ‚Äì —ç—Ç–æ SQL –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–Ω—ã–π –ø–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ Hibernate. –£ –Ω–µ–≥–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã—Ö –æ—Ç–ª–∏—á–∏–π.

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ¬†**–∏–º–µ–Ω–∏ –∫–ª–∞—Å—Å–∞**¬†–≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã.
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ¬†**–∏–º–µ–Ω–∏ –ø–æ–ª—è –∫–ª–∞—Å—Å–∞**¬†–≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã.
3. **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**¬†–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ select.

–î–∞–≤–∞–π –ø–æ–ø—Ä–æ—Å–∏–º Hibernate –≤–µ—Ä–Ω—É—Ç—å –Ω–∞–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å —É –Ω–µ–≥–æ –≤ –±–∞–∑–µ. –í–æ—Ç –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å:
```java
from User
```

`User` - —ç—Ç–æ –∏–º—è –∫–ª–∞—Å—Å–∞



–í–æ—Ç –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–æ–¥ –≤ Java –ø–æ–ª–Ω–æ—Å—Ç—å—é:
```java
public List<User> getAllUsers() {
    try (Session session = sessionFactory.openSession()) {
            return session.createQuery("from User", User.class).list();
    }
}
```


–í –æ—Å—Ç–∞–ª—å–Ω–æ–º HQL –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂ –Ω–∞ SQL ‚Äì –≤ –Ω–µ–º —Ç–æ–∂–µ –µ—Å—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:
- `WHERE`
- `ORDER BY`
- `GROUP BY`
- `HAVING`



### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ select

–í HQL –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å¬†`select`, –∫–æ–≥–¥–∞ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–∏–ø–æ–º —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤¬†`from`.

–ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –Ω–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ¬†**user_data**, —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å:

```java
select name from User
```

–ù—É –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```java
public List<String> getUserNames() {
    try (Session session = sessionFactory.openSession()) {
            String hql = "select distinct u.name from User u where u.created > '2020-01-01'";
            Query<String> query = session.createQuery(hql , String.class);
            return query.list();
    }
}
```





## –ò–∑—É—á–∞–µ–º –∫–ª–∞—Å—Å Query

–õ–µ–∫—Ü–∏—è: https://javarush.com/quests/lectures/questhibernate.level10.lecture01


```java
public List<Employee> getAllEmployes() {
    try (Session session = sessionFactory.openSession()) {
            Query<Employee> query = session.createQuery("from Employee", Employee.class);
            return query.list();
    }
}
```

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, Query ‚Äì —ç—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Å–ª—É—á–∞–∏. –ù–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —è –±—É–¥—É –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –Ω–∞–∑—ã–≤–∞—Ç—å –µ–≥–æ –∫–ª–∞—Å—Å–æ–º. –≠—Ç–æ, —Å–∫–∞–∂–µ–º —Ç–∞–∫, –∫–ª–∞—Å—Å –≤ —à–∏—Ä–æ–∫–æ–º —Å–º—ã—Å–ª–µ ‚Äì –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –û–û–ü.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ. –†–∞–Ω—å—à–µ –±—ã–ª–æ –¥–≤–∞ –∫–ª–∞—Å—Å–∞:

- **Query**¬†–¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.
- **TypedQuery**¬†–¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ç–∏–ø–æ–º.




## Join –≤ HQL

–õ–µ–∫—Ü–∏—è: https://javarush.com/quests/lectures/questhibernate.level10.lecture02


```java
@ManyToOne @JoinColumn(name="employee_id", nullable=true)
public Employee employee;
```

–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è¬†`@ManyToOne`¬†–≥–æ–≤–æ—Ä–∏—Ç Hibernate, —á—Ç–æ –º–Ω–æ–≥–æ —Å—É—â–Ω–æ—Å—Ç–µ–π¬†**EmployeeTask**¬†–º–æ–≥—É—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –æ–¥–Ω—É —Å—É—â–Ω–æ—Å—Ç—å¬†**Employee**.

–ê –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è¬†`@JoinColumn`¬†—É–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –∫–æ–ª–æ–Ω–∫–∏, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –±—Ä–∞—Ç—å—Å—è¬†**id**. –í—Å—è –æ—Å—Ç–∞–ª—å–Ω–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –≤–∑—è—Ç–∞ –∏–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∫–ª–∞—Å—Å–∞ Employee.

–ü—Ä–∏–º–µ—Ä –±–µ–∑ JOIN

```java
@Entity @Table(name="task")
class EmployeeTask {
   @Column(name="id")
   public Integer id;

   @Column(name="name")
   public String name;

   @Column(name="employee_id")
   public Integer employeeId;

   @Column(name="deadline")
   public Date deadline;
}
```

–ü—Ä–∏–º–µ—Ä —Å JOIN
```java
@Entity @Table(name="task")
class EmployeeTask
{
   @Column(name="id")
   public Integer id;

   @Column(name="name")
   public String name;

   @ManyToOne @JoinColumn(name="employee_id", nullable=true)
   public Employee employee;

   @Column(name="deadline")
   public Date deadline;
}
```



